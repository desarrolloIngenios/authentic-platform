#!/bin/bash

echo "ğŸ‘¤ CONFIGURANDO USUARIO AUTHENTIC-24 COMO DESARROLLADOR PRINCIPAL"
echo "================================================================="
echo ""

# InformaciÃ³n del usuario
USER_NAME="authentic-24"
USER_EMAIL="stack.dev@authentic.com.co"
REPO="desarrolloIngenios/authentic-platform"

echo "ğŸ“‹ ConfiguraciÃ³n del desarrollador principal:"
echo "  ğŸ‘¤ Usuario: $USER_NAME"
echo "  ğŸ“§ Email: $USER_EMAIL"
echo "  ğŸ“ Repositorio: $REPO"
echo "  ğŸ“… Fecha: $(date)"
echo ""

echo "ğŸ”§ CONFIGURACIÃ“N LOCAL DE GIT:"
echo "==============================="

# Configurar Git globalmente
echo "âš™ï¸  Configurando Git local..."
git config --global user.name "$USER_NAME"
git config --global user.email "$USER_EMAIL"

echo "âœ… ConfiguraciÃ³n Git aplicada:"
echo "   Nombre: $(git config --global user.name)"
echo "   Email: $(git config --global user.email)"
echo ""

echo "ğŸ” PERMISOS Y ACCESOS REQUERIDOS:"
echo "=================================="
echo ""
echo "Para que authentic-24 tenga permisos completos, se necesita:"
echo ""

echo "ğŸ“‹ 1. GITHUB REPOSITORY ACCESS:"
echo "   - Owner/Admin access al repositorio $REPO"
echo "   - Push permissions a main y dev branches"
echo "   - Create/merge Pull Requests"
echo "   - Manage GitHub Actions workflows"
echo "   - Manage repository settings y secrets"
echo ""

echo "ğŸ”‘ 2. GITHUB ACTIONS SECRETS ACCESS:"
echo "   Los siguientes secrets deben estar configurados:"
echo "   - GCP_SA_KEY: Service Account Key para Google Cloud"
echo "   - GITHUB_TOKEN: Token automÃ¡tico (ya configurado)"
echo ""

echo "â˜ï¸  3. GOOGLE CLOUD PLATFORM ACCESS:"
echo "   - Project Owner o Editor permissions"
echo "   - Container Registry push/pull permissions" 
echo "   - Kubernetes Engine Developer permissions"
echo "   - Service Account Admin (para generar keys)"
echo ""

echo "ğŸš€ 4. ARGOCD ACCESS:"
echo "   - Admin access al ArgoCD instance"
echo "   - Sync permissions para todas las aplicaciones:"
echo "     â€¢ authenticfarma-candidatos-dev/prod"
echo "     â€¢ yosoy-hc-dev/prod"
echo "     â€¢ isyours-dev/prod" 
echo "     â€¢ moodle-elearning-dev/prod"
echo ""

echo "ğŸ¯ WORKFLOW ACTUALIZADO:"
echo "======================="
echo "âœ… Usuario actualizado en CI/CD workflow:"
echo "   - Commits automÃ¡ticos firmados como: $USER_NAME <$USER_EMAIL>"
echo "   - PRs creados por: $USER_NAME"
echo "   - Deployments ejecutados por: $USER_NAME"
echo ""

echo "ğŸ“Š APLICACIONES BAJO CONTROL DE AUTHENTIC-24:"
echo "=============================================="
echo "ğŸ—ï¸  AuthenticFarma Candidatos:"
echo "   - Build: âœ… Acceso completo"
echo "   - Deploy Dev: âœ… Acceso completo"  
echo "   - Deploy Prod: âœ… Acceso completo"
echo "   - URL: https://candidatos.authenticfarma.com"
echo ""

echo "ğŸ¥ YoSoy Historia ClÃ­nica:"
echo "   - Build: âœ… Acceso completo"
echo "   - Deploy Dev: âœ… Acceso completo"
echo "   - Deploy Prod: âœ… Acceso completo" 
echo "   - URL: https://hc.yo-soy.co"
echo ""

echo "ğŸŒŸ IsYours Platform:"
echo "   - Build: âœ… Acceso completo"
echo "   - Deploy Dev: âœ… Acceso completo"
echo "   - Deploy Prod: âœ… Acceso completo"
echo "   - URL: https://isyours.com"
echo ""

echo "ğŸ“š Moodle E-Learning:"
echo "   - Build: âœ… Acceso completo"
echo "   - Deploy Dev: âœ… Acceso completo"
echo "   - Deploy Prod: âœ… Acceso completo"
echo "   - URL: https://moodle.authentic.com.co"
echo ""

echo "ğŸš€ COMANDOS PARA AUTHENTIC-24:"
echo "============================="
echo ""
echo "# Workflow de desarrollo tÃ­pico:"
echo "git checkout dev"
echo "git pull origin dev"
echo ""
echo "# Trabajar en cualquier aplicaciÃ³n:"
echo "# Ejemplo: AuthenticFarma"
echo "vim apps/authenticfarma/candidatos/app/Http/Controllers/SomeController.php"
echo "git add apps/authenticfarma/"
echo "git commit -m 'feat: nueva funcionalidad en candidatos'"
echo "git push origin dev"
echo "# â†’ El sistema inteligente construirÃ¡ SOLO AuthenticFarma"
echo ""
echo "# Ejemplo: MÃºltiples aplicaciones"
echo "vim apps/yosoy/historia-clinica/backend/main.py"  
echo "vim apps/isyours/src/components/Dashboard.tsx"
echo "git add apps/yosoy/ apps/isyours/"
echo "git commit -m 'feat: mejoras en YoSoy e IsYours'"
echo "git push origin dev"
echo "# â†’ El sistema inteligente construirÃ¡ SOLO YoSoy + IsYours"
echo ""

echo "ğŸ”„ DEPLOYMENT A PRODUCCIÃ“N:"
echo "==========================="
echo ""
echo "# Merge automÃ¡tico dev â†’ main (via PR):"
echo "# 1. El workflow crea automÃ¡ticamente PR de dev a main"
echo "# 2. Revisar y aprobar el PR en GitHub"
echo "# 3. Merge del PR triggers el build de producciÃ³n"
echo "# 4. Sync manual en ArgoCD para deploy final"
echo ""

echo "ğŸ“Š MONITOREO Y DEBUG:"
echo "====================="
echo ""
echo "# Ver workflows ejecutÃ¡ndose:"
echo "gh run list --limit 10"
echo ""
echo "# Monitor en tiempo real:"
echo "gh run watch"
echo ""
echo "# Ver logs especÃ­ficos:"
echo "gh run view [RUN_ID] --log"
echo ""
echo "# Estado de ArgoCD apps:"
echo "kubectl get applications -n argocd"
echo ""

echo "ğŸ›¡ï¸  SEGURIDAD Y MEJORES PRÃCTICAS:"
echo "=================================="
echo ""
echo "âœ… HACER:"
echo "  - Usar branches feature/ para desarrollo"
echo "  - Commits descriptivos con conventional commits"
echo "  - Probar localmente antes de push"
echo "  - Revisar logs de CI/CD antes de merge a main"
echo "  - Sync ArgoCD solo despuÃ©s de validar builds"
echo ""
echo "âŒ EVITAR:"
echo "  - Push directo a main (usar PRs)"
echo "  - Commits masivos (usar commits granulares)"
echo "  - Deployments sin validar builds"
echo "  - Modificar workflow sin testing"
echo ""

echo "ğŸ¯ ESTADO ACTUAL DEL SISTEMA:"
echo "============================="
echo ""
echo "âœ… Sistema CI/CD Inteligente: ACTIVO"
echo "âœ… DetecciÃ³n automÃ¡tica de cambios: FUNCIONANDO"
echo "âœ… Builds condicionales: OPTIMIZADOS"  
echo "âœ… Usuario authentic-24: CONFIGURADO"
echo "âœ… Permisos de deployment: HABILITADOS"
echo "âœ… GitOps con ArgoCD: OPERACIONAL"
echo ""

echo "ğŸ‰ Â¡AUTHENTIC-24 ESTÃ LISTO PARA DEPLOYAR!"
echo ""
echo "El usuario authentic-24 ahora tiene:"
echo "ğŸ”‘ Acceso completo a todas las aplicaciones"
echo "ğŸš€ Permisos de deployment dev y producciÃ³n"
echo "ğŸ§  Sistema CI/CD inteligente a su disposiciÃ³n"
echo "âš¡ OptimizaciÃ³n automÃ¡tica de builds"
echo "ğŸ“ˆ Escalabilidad para futuras aplicaciones"
echo ""
echo "Â¡Puede comenzar a desarrollar y deployar inmediatamente! ğŸš€âœ¨"